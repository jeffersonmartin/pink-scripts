# Apache Virtual Host Configuration for Labstack
# Generated by Labstack

<VirtualHost *:80>

    #
    # Labstack Admin UI - redirect to HTTPS
    #

    ServerName admin.cell{ENV_CELL_NUMBER}.labstack.local
    Redirect permanent / https://admin.cell{ENV_CELL_NUMBER}.labstack.local

</VirtualHost>

<IfModule mod_ssl.c>
    <VirtualHost _default_:443>

        #
        # Labstack Admin UI HTTPS
        #

        ServerName admin.cell{ENV_CELL_NUMBER}.labstack.local

        DocumentRoot /srv/labstack/apache/admin/public
        <Directory /srv/labstack/apache/admin/public>
            Options FollowSymLinks MultiViews
            AllowOverride All
            Order allow,deny
            allow from all
        </Directory>

        ServerName admin.cell{ENV_CELL_NUMBER}.labstack.local

        SSLEngine on
        SSLCertificateFile /srv/labstack/ssl/labstack-apache.crt
        SSLCertificateKeyFile /srv/labstack/ssl/labstack-apache.key

        <FilesMatch "\.(cgi|shtml|phtml|php)$">
                        SSLOptions +StdEnvVars
        </FilesMatch>
        <Directory /usr/lib/cgi-bin>
                        SSLOptions +StdEnvVars
        </Directory>
        BrowserMatch "MSIE [2-6]" \
                        nokeepalive ssl-unclean-shutdown \
                        downgrade-1.0 force-response-1.0
        BrowserMatch "MSIE [17-9]" ssl-unclean-shutdown

        ErrorLog /srv/labstack/log/apache/admin/error.log
        CustomLog /srv/labstack/log/apache/admin/access.log combined

    </VirtualHost>
</IfModule>

<VirtualHost *:80>

    #
    # Labstack Public File Server (HTTP 80)
    #

    ServerName file.cell{ENV_CELL_NUMBER}.labstack.local
    DocumentRoot /srv/labstack/file/public

    <Directory /srv/labstack/file/public>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    ErrorLog /srv/labstack/log/apache/file/public/error.log
    CustomLog /srv/labstack/log/apache/file/public/access.log combined

</VirtualHost>

<VirtualHost *:8080>

    #
    # Labstack Private File Server (HTTP 8080)
    #

    ServerName file.cell{ENV_CELL_NUMBER}.labstack.local
    DocumentRoot /srv/labstack/file/private

    <Directory /srv/labstack/file/private>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    ErrorLog /srv/labstack/log/apache/file/private/error.log
    CustomLog /srv/labstack/log/apache/file/private/access.log combined

</VirtualHost>

<VirtualHost *:80>

    #
    # Labstack Script Server - redirect to Admin HTTPS
    #

    ServerName script.cell{ENV_CELL_NUMBER}.labstack.local
    Redirect permanent / https://admin.cell{ENV_CELL_NUMBER}.labstack.local

</VirtualHost>

<VirtualHost *:8080>

    #
    # Labstack Script Server (HTTP 8080)
    #

    ServerName script.cell{ENV_CELL_NUMBER}.labstack.local
    DocumentRoot /srv/labstack/apache/script/public

    <Directory /srv/labstack/apache/script/public>
        Options Indexes FollowSymLinks MultiViews
        AllowOverride None
        Order allow,deny
        allow from all
    </Directory>

    ErrorLog /srv/labstack/log/apache/script/error.log
    CustomLog /srv/labstack/log/apache/script/access.log combined

</VirtualHost>
